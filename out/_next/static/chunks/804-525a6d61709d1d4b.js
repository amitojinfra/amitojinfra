"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[804],{4069:function(e,t,r){r.d(t,{CW:function(){return d},Jx:function(){return i},RT:function(){return h},UR:function(){return c},uO:function(){return a},wO:function(){return n},xi:function(){return s}});let a=e=>{let t={},r=!0;if(e.name&&""!==e.name.trim()?e.name.trim().length<2?(t.name="Name must be at least 2 characters long",r=!1):e.name.trim().length>100&&(t.name="Name must not exceed 100 characters",r=!1):(t.name="Name is required",r=!1),e.aadhar_id&&""!==e.aadhar_id.trim()&&!/^\d{12}$/.test(e.aadhar_id.trim())&&(t.aadhar_id="Aadhar ID must be exactly 12 digits",r=!1),e.joining_date){let a=new Date(e.joining_date),n=new Date,i=new Date("1990-01-01");isNaN(a.getTime())?(t.joining_date="Invalid joining date",r=!1):a>n?(t.joining_date="Joining date cannot be in the future",r=!1):a<i&&(t.joining_date="Joining date cannot be before 1990",r=!1)}else t.joining_date="Joining date is required",r=!1;if(void 0!==e.age&&null!==e.age&&""!==e.age){let a=parseInt(e.age);(isNaN(a)||a<18||a>65)&&(t.age="Age must be between 18 and 65",r=!1)}return{isValid:r,errors:t}},n=e=>{var t;return e?{...e,name:(null===(t=e.name)||void 0===t?void 0:t.trim())||"N/A",aadhar_id:e.aadhar_id?o(e.aadhar_id):"Not provided",joining_date:e.joining_date?l(e.joining_date):"N/A",age:e.age?"".concat(e.age," years"):"Not specified",formatted_joining_date:e.joining_date?new Date(e.joining_date).toLocaleDateString():"N/A"}:null},i=e=>{var t;let r={name:(null===(t=e.name)||void 0===t?void 0:t.trim())||"",joining_date:e.joining_date||null};return e.aadhar_id&&""!==e.aadhar_id.trim()&&(r.aadhar_id=e.aadhar_id.trim()),void 0!==e.age&&null!==e.age&&""!==e.age&&(r.age=parseInt(e.age)),r},o=e=>e&&12===e.length?"".concat(e.substring(0,4),"-****-").concat(e.substring(8)):e,l=e=>{if(!e)return"N/A";try{let t="string"==typeof e?new Date(e):e;if(isNaN(t.getTime()))return"Invalid Date";return t.toLocaleDateString("en-IN",{year:"numeric",month:"long",day:"numeric"})}catch(e){return"Invalid Date"}},c=e=>{if(!e)return"N/A";try{let t=new Date(e),r=new Date;if(isNaN(t.getTime()))return"N/A";let a=Math.ceil(Math.abs(r-t)/864e5),n=Math.floor(a/365),i=Math.floor(a%365/30);if(0===n&&0===i)return"Less than a month";if(0===n)return"".concat(i," month").concat(i>1?"s":"");if(0===i)return"".concat(n," year").concat(n>1?"s":"");return"".concat(n," year").concat(n>1?"s":"",", ").concat(i," month").concat(i>1?"s":"")}catch(e){return"N/A"}},s=e=>{let t=[];if(e.name){t.push(e.name.toLowerCase());let r=e.name.toLowerCase().split(" ");t.push(...r)}if(e.aadhar_id&&t.push(e.aadhar_id),e.joining_date){let r=new Date(e.joining_date).getFullYear();t.push(r.toString())}return[...new Set(t)]},d=()=>({name:"",aadhar_id:"",joining_date:"",age:""}),h=e=>{if(!e)return{status:"unknown",label:"Unknown",color:"#6c757d"};try{let t=new Date(e),r=new Date,a=Math.floor((r-t)/864e5);if(a<0)return{status:"future",label:"Future Joining",color:"#17a2b8"};if(a<=90)return{status:"new",label:"New Employee",color:"#28a745"};if(a<=365)return{status:"recent",label:"Recent Hire",color:"#ffc107"};return{status:"experienced",label:"Experienced",color:"#007bff"}}catch(e){return{status:"unknown",label:"Unknown",color:"#6c757d"}}}},8804:function(e,t,r){var a=r(5799),n=r(4069);class i{async createEmployee(e){try{let t=(0,n.uO)(e);if(!t.isValid)throw Error("Validation failed: ".concat(Object.values(t.errors).join(", ")));if(e.aadhar_id&&""!==e.aadhar_id.trim()&&await this.findByAadharId(e.aadhar_id.trim()))throw Error("An employee with this Aadhar ID already exists");let r=(0,n.Jx)(e);return r.searchKeywords=(0,n.xi)(r),r.status="active",{id:(await a.Z.addDocument(this.collectionName,r)).id,...r}}catch(e){throw console.error("Error creating employee:",e),e}}async getEmployee(e){try{return await a.Z.getDocument(this.collectionName,e)}catch(e){throw console.error("Error getting employee:",e),e}}async updateEmployee(e,t){try{let r=(0,n.uO)(t);if(!r.isValid)throw Error("Validation failed: ".concat(Object.values(r.errors).join(", ")));if(t.aadhar_id&&""!==t.aadhar_id.trim()){let r=await this.findByAadharId(t.aadhar_id.trim());if(r&&r.id!==e)throw Error("An employee with this Aadhar ID already exists")}let i=(0,n.Jx)(t);i.searchKeywords=(0,n.xi)(i),await a.Z.updateDocument(this.collectionName,e,i)}catch(e){throw console.error("Error updating employee:",e),e}}async deleteEmployee(e){try{await a.Z.updateDocument(this.collectionName,e,{status:"inactive",deletedAt:new Date().toISOString()})}catch(e){throw console.error("Error deleting employee:",e),e}}async permanentlyDeleteEmployee(e){try{await a.Z.deleteDocument(this.collectionName,e)}catch(e){throw console.error("Error permanently deleting employee:",e),e}}async getAllEmployees(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{let t={where:[{field:"status",operator:"==",value:"active"}],orderBy:{field:"createdAt",direction:"desc"},...e};return await a.Z.getDocuments(this.collectionName,t)}catch(e){throw console.error("Error getting all employees:",e),e}}async searchEmployees(e){try{if(!e||""===e.trim())return await this.getAllEmployees();let t=e.toLowerCase().trim();return(await this.getAllEmployees()).filter(e=>!!(e.name&&e.name.toLowerCase().includes(t)||e.aadhar_id&&e.aadhar_id.includes(t)||e.searchKeywords&&e.searchKeywords.some(e=>e.includes(t))))}catch(e){throw console.error("Error searching employees:",e),e}}async findByAadharId(e){try{if(!e||""===e.trim())return null;let t=await a.Z.getDocuments(this.collectionName,{where:[{field:"aadhar_id",operator:"==",value:e.trim()},{field:"status",operator:"==",value:"active"}],limit:1});return t.length>0?t[0]:null}catch(e){throw console.error("Error finding employee by Aadhar ID:",e),e}}async getEmployeesByJoiningDateRange(e,t){try{return(await this.getAllEmployees()).filter(r=>{if(!r.joining_date)return!1;let a=new Date(r.joining_date);return a>=e&&a<=t})}catch(e){throw console.error("Error getting employees by joining date range:",e),e}}async getEmployeesByAgeRange(e,t){try{return(await this.getAllEmployees()).filter(r=>!!r.age&&r.age>=e&&r.age<=t)}catch(e){throw console.error("Error getting employees by age range:",e),e}}async getEmployeeStats(){try{let e=await this.getAllEmployees(),t={total:e.length,withAadhar:e.filter(e=>e.aadhar_id).length,withAge:e.filter(e=>e.age).length,avgAge:0,newestHire:null,oldestHire:null,ageDistribution:{"18-25":0,"26-35":0,"36-45":0,"46-55":0,"56-65":0}};if(e.length>0){let r=e.filter(e=>e.age);r.length>0&&(t.avgAge=Math.round(r.reduce((e,t)=>e+t.age,0)/r.length));let a=e.filter(e=>e.joining_date).sort((e,t)=>new Date(t.joining_date)-new Date(e.joining_date));a.length>0&&(t.newestHire=a[0],t.oldestHire=a[a.length-1]),r.forEach(e=>{let r=e.age;r>=18&&r<=25?t.ageDistribution["18-25"]++:r>=26&&r<=35?t.ageDistribution["26-35"]++:r>=36&&r<=45?t.ageDistribution["36-45"]++:r>=46&&r<=55?t.ageDistribution["46-55"]++:r>=56&&r<=65&&t.ageDistribution["56-65"]++})}return t}catch(e){throw console.error("Error getting employee stats:",e),e}}subscribeToEmployees(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let r={where:[{field:"status",operator:"==",value:"active"}],orderBy:{field:"createdAt",direction:"desc"},...t};return a.Z.subscribeToCollection(this.collectionName,e,r)}catch(e){throw console.error("Error subscribing to employees:",e),e}}subscribeToEmployee(e,t){try{return a.Z.subscribeToDocument(this.collectionName,e,t)}catch(e){throw console.error("Error subscribing to employee:",e),e}}async batchCreateEmployees(e){try{let t=[],r=[];for(let a=0;a<e.length;a++)try{let r=await this.createEmployee(e[a]);t.push({index:a,success:!0,employee:r})}catch(t){r.push({index:a,error:t.message,data:e[a]})}return{results:t,errors:r}}catch(e){throw console.error("Error batch creating employees:",e),e}}constructor(){this.collectionName="employees"}}let o=new i;t.Z=o}}]);