"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[724],{5724:function(e,s,a){var d=a(5893),t=a(645),r=a.n(t),o=a(7294),c=a(3615),i=a(5468),n=a(8968);s.Z=e=>{let{employees:s=[],selectedDate:a=null,mode:t="single",onSubmit:l,onCancel:b,loading:x=!1}=e,{user:m}=(0,c.a)(),[p,u]=(0,o.useState)({date:a||new Date().toISOString().split("T")[0],employees:[],bulkStatus:i.H8.PRESENT,notes:""}),[f,j]=(0,o.useState)(new Set),[g,h]=(0,o.useState)(!1),[k,y]=(0,o.useState)(!1),[w,z]=(0,o.useState)({}),[N,v]=(0,o.useState)(new Set),[S,A]=(0,o.useState)(!1);(0,o.useEffect)(()=>{a&&u(e=>({...e,date:a}))},[a]),(0,o.useEffect)(()=>{if(s.length>0&&"bulk"===t){let e=s.map(e=>({...(0,i.dP)(),employee_id:e.id,employee_name:e.name,date:p.date,status:i.H8.PRESENT,marked_by:(null==m?void 0:m.uid)||(null==m?void 0:m.email)||"admin"}));u(s=>({...s,employees:e}))}},[s,t,m,p.date]),(0,o.useEffect)(()=>{(async()=>{if(s.length>0&&p.date&&"bulk"===t){A(!0);try{let e=s.map(e=>e.id),a=await n.Z.getEmployeesWithAttendanceForDate(e,p.date);v(a)}catch(e){console.error("Error checking existing attendance:",e),v(new Set)}finally{A(!1)}}})()},[s,p.date,t]);let E=(e,s)=>{u(a=>({...a,employees:a.employees.map(a=>a.employee_id===e?{...a,status:s}:a)}))},H=e=>{let a=new Set(f);a.has(e)?a.delete(e):a.add(e),j(a),h(a.size===s.length)},D=()=>{let e={};return p.date?new Date(p.date)>new Date&&(e.date="Cannot mark attendance for future dates"):e.date="Date is required","bulk"===t&&0===f.size&&(e.employees="Please select at least one employee"),z(e),0===Object.keys(e).length},_=async e=>{if(e.preventDefault(),D()){y(!0);try{if("bulk"===t){let e=p.employees.filter(e=>f.has(e.employee_id));await l(e)}else await l(p)}catch(e){console.error("Form submission error:",e),z({general:e.message||"An error occurred while marking attendance"})}finally{y(!1)}}},C=e=>{switch(e){case i.H8.PRESENT:return"#d4edda";case i.H8.ABSENT:return"#f8d7da";case i.H8.HALF_DAY:return"#fff3cd";default:return"#f8f9fa"}},T=e=>{switch(e){case i.H8.PRESENT:return"#c3e6cb";case i.H8.ABSENT:return"#f5c6cb";case i.H8.HALF_DAY:return"#ffeaa7";default:return"#dee2e6"}};return(0,d.jsxs)("div",{className:"jsx-4306d481946cbdc0 attendance-form",children:[(0,d.jsxs)("form",{onSubmit:_,className:"jsx-4306d481946cbdc0 form",children:[(0,d.jsxs)("div",{className:"jsx-4306d481946cbdc0 form-header",children:[(0,d.jsx)("h2",{className:"jsx-4306d481946cbdc0",children:"bulk"===t?"Mark Bulk Attendance":"Mark Attendance"}),(0,d.jsx)("p",{className:"jsx-4306d481946cbdc0 form-description",children:"Mark attendance for employees on the selected date"})]}),w.general&&(0,d.jsxs)("div",{className:"jsx-4306d481946cbdc0 error-banner",children:[(0,d.jsx)("strong",{className:"jsx-4306d481946cbdc0",children:"Error:"})," ",w.general]}),(0,d.jsxs)("div",{className:"jsx-4306d481946cbdc0 form-group",children:[(0,d.jsx)("label",{htmlFor:"date",className:"jsx-4306d481946cbdc0 form-label",children:"Attendance Date *"}),(0,d.jsx)("input",{type:"date",id:"date",value:p.date,onChange:e=>{let s=e.target.value;u(e=>({...e,date:s,employees:e.employees.map(e=>({...e,date:s}))})),w.date&&z(e=>({...e,date:""}))},max:new Date().toISOString().split("T")[0],required:!0,className:"jsx-4306d481946cbdc0 "+"form-input ".concat(w.date?"error":"")}),w.date&&(0,d.jsx)("div",{className:"jsx-4306d481946cbdc0 error-message",children:w.date})]}),"bulk"===t&&(0,d.jsxs)(d.Fragment,{children:[S&&(0,d.jsx)("div",{className:"jsx-4306d481946cbdc0 checking-indicator",children:(0,d.jsxs)("span",{className:"jsx-4306d481946cbdc0",children:["\uD83D\uDD0D Checking existing attendance for ",p.date,"..."]})}),!S&&N.size>0&&(0,d.jsx)("div",{className:"jsx-4306d481946cbdc0 duplicate-info",children:(0,d.jsxs)("span",{className:"jsx-4306d481946cbdc0",children:["ℹ️ ",N.size," employee(s) already have attendance marked for this date. Selecting them will update their existing records."]})}),!S&&0===N.size&&s.length>0&&(0,d.jsx)("div",{className:"jsx-4306d481946cbdc0 no-duplicates-info",children:(0,d.jsxs)("span",{className:"jsx-4306d481946cbdc0",children:["✅ No existing attendance found for ",p.date,". All records will be created as new."]})}),(0,d.jsxs)("div",{className:"jsx-4306d481946cbdc0 bulk-controls",children:[(0,d.jsxs)("div",{className:"jsx-4306d481946cbdc0 bulk-actions",children:[(0,d.jsx)("div",{className:"jsx-4306d481946cbdc0 select-all",children:(0,d.jsxs)("label",{className:"jsx-4306d481946cbdc0 checkbox-label",children:[(0,d.jsx)("input",{type:"checkbox",checked:g,onChange:()=>{g?j(new Set):j(new Set(s.map(e=>e.id))),h(!g)},className:"jsx-4306d481946cbdc0"}),(0,d.jsxs)("span",{className:"jsx-4306d481946cbdc0",children:["Select All (",s.length," employees)"]})]})}),(0,d.jsxs)("div",{className:"jsx-4306d481946cbdc0 bulk-status",children:[(0,d.jsxs)("select",{value:p.bulkStatus,onChange:e=>{let s=e.target.value;u(e=>({...e,bulkStatus:s,employees:e.employees.map(e=>f.has(e.employee_id)?{...e,status:s}:e)}))},className:"jsx-4306d481946cbdc0 bulk-status-select",children:[(0,d.jsx)("option",{value:i.H8.PRESENT,className:"jsx-4306d481946cbdc0",children:"Mark as Present"}),(0,d.jsx)("option",{value:i.H8.ABSENT,className:"jsx-4306d481946cbdc0",children:"Mark as Absent"}),(0,d.jsx)("option",{value:i.H8.HALF_DAY,className:"jsx-4306d481946cbdc0",children:"Mark as Half Day"})]}),(0,d.jsxs)("button",{type:"button",onClick:()=>{u(e=>({...e,employees:e.employees.map(e=>f.has(e.employee_id)?{...e,status:p.bulkStatus}:e)}))},disabled:0===f.size,className:"jsx-4306d481946cbdc0 apply-bulk-btn",children:["Apply to Selected (",f.size,")"]})]})]}),w.employees&&(0,d.jsx)("div",{className:"jsx-4306d481946cbdc0 error-message",children:w.employees})]}),(0,d.jsxs)("div",{className:"jsx-4306d481946cbdc0 employee-list",children:[(0,d.jsxs)("div",{className:"jsx-4306d481946cbdc0 list-header",children:[(0,d.jsxs)("h3",{className:"jsx-4306d481946cbdc0",children:["Employees (",s.length,")"]}),(0,d.jsxs)("div",{className:"jsx-4306d481946cbdc0 selected-count",children:["Selected: ",f.size," / ",s.length]})]}),(0,d.jsx)("div",{className:"jsx-4306d481946cbdc0 employee-grid",children:p.employees.map((e,a)=>{let t=s.find(s=>s.id===e.employee_id);if(!t)return null;let r=f.has(t.id);return(0,d.jsxs)("div",{style:{backgroundColor:C(e.status),borderColor:T(e.status)},className:"jsx-4306d481946cbdc0 "+"employee-item ".concat(r?"selected":""),children:[(0,d.jsx)("div",{className:"jsx-4306d481946cbdc0 employee-header",children:(0,d.jsxs)("label",{className:"jsx-4306d481946cbdc0 checkbox-label",children:[(0,d.jsx)("input",{type:"checkbox",checked:r,onChange:()=>H(t.id),className:"jsx-4306d481946cbdc0"}),(0,d.jsxs)("span",{className:"jsx-4306d481946cbdc0 employee-name",children:[t.name,N.has(t.id)&&(0,d.jsx)("span",{title:"Attendance already marked for this date",className:"jsx-4306d481946cbdc0 attendance-indicator",children:"✅ Already Marked"})]})]})}),(0,d.jsxs)("div",{className:"jsx-4306d481946cbdc0 employee-info",children:[(0,d.jsxs)("div",{className:"jsx-4306d481946cbdc0 employee-id",children:["ID: ",t.id.slice(0,8),"..."]}),t.aadhar_id&&(0,d.jsxs)("div",{className:"jsx-4306d481946cbdc0 employee-aadhar",children:["Aadhar: ",t.aadhar_id.slice(0,4),"****",t.aadhar_id.slice(-4)]})]}),(0,d.jsx)("div",{className:"jsx-4306d481946cbdc0 status-controls",children:(0,d.jsx)("div",{className:"jsx-4306d481946cbdc0 status-buttons",children:Object.values(i.H8).map(s=>(0,d.jsxs)("button",{type:"button",onClick:()=>E(t.id,s),"data-status":s,className:"jsx-4306d481946cbdc0 "+"status-btn ".concat(e.status===s?"active":""),children:[s===i.H8.PRESENT&&"✓ Present",s===i.H8.ABSENT&&"✗ Absent",s===i.H8.HALF_DAY&&"◐ Half Day"]},s))})})]},t.id)})})]})]}),(0,d.jsxs)("div",{className:"jsx-4306d481946cbdc0 form-group",children:[(0,d.jsx)("label",{htmlFor:"notes",className:"jsx-4306d481946cbdc0 form-label",children:"Notes (Optional)"}),(0,d.jsx)("textarea",{id:"notes",value:p.notes,onChange:e=>u(s=>({...s,notes:e.target.value})),placeholder:"Add any additional notes about attendance...",rows:"3",maxLength:"500",className:"jsx-4306d481946cbdc0 form-textarea"}),(0,d.jsxs)("div",{className:"jsx-4306d481946cbdc0 field-hint",children:[p.notes.length,"/500 characters"]})]}),(0,d.jsxs)("div",{className:"jsx-4306d481946cbdc0 form-actions",children:[(0,d.jsx)("button",{type:"button",onClick:b,disabled:k||x,className:"jsx-4306d481946cbdc0 btn-secondary",children:"Cancel"}),(0,d.jsx)("button",{type:"submit",disabled:k||x||"bulk"===t&&0===f.size,className:"jsx-4306d481946cbdc0 btn-primary",children:k||x?"Marking Attendance...":"Mark Attendance".concat("bulk"===t?" (".concat(f.size,")"):"")})]})]}),(0,d.jsx)(r(),{id:"4306d481946cbdc0",children:'.attendance-form.jsx-4306d481946cbdc0{max-width:1e3px;margin:0 auto;padding:20px}.form.jsx-4306d481946cbdc0{background:white;padding:30px;-webkit-border-radius:8px;-moz-border-radius:8px;border-radius:8px;-webkit-box-shadow:0 2px 10px rgba(0,0,0,.1);-moz-box-shadow:0 2px 10px rgba(0,0,0,.1);box-shadow:0 2px 10px rgba(0,0,0,.1)}.form-header.jsx-4306d481946cbdc0{margin-bottom:30px;text-align:center}.form-header.jsx-4306d481946cbdc0 h2.jsx-4306d481946cbdc0{margin:0 0 10px 0;color:#333;font-size:1.5rem}.form-description.jsx-4306d481946cbdc0{margin:0;color:#666;font-size:.9rem}.error-banner.jsx-4306d481946cbdc0{background:#fee;color:#c33;padding:12px;-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px;margin-bottom:20px;border:1px solid#fcc}.form-group.jsx-4306d481946cbdc0{margin-bottom:20px}.form-label.jsx-4306d481946cbdc0{display:block;margin-bottom:6px;font-weight:500;color:#333;font-size:.9rem}.form-input.jsx-4306d481946cbdc0,.form-textarea.jsx-4306d481946cbdc0{width:100%;padding:12px;border:1px solid#ddd;-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px;font-size:14px;-webkit-transition:border-color.2s,box-shadow.2s;-moz-transition:border-color.2s,box-shadow.2s;-o-transition:border-color.2s,box-shadow.2s;transition:border-color.2s,box-shadow.2s}.form-input.jsx-4306d481946cbdc0:focus,.form-textarea.jsx-4306d481946cbdc0:focus{outline:none;border-color:#007cba;-webkit-box-shadow:0 0 0 2px rgba(0,124,186,.2);-moz-box-shadow:0 0 0 2px rgba(0,124,186,.2);box-shadow:0 0 0 2px rgba(0,124,186,.2)}.form-input.error.jsx-4306d481946cbdc0,.form-textarea.error.jsx-4306d481946cbdc0{border-color:#dc3545}.error-message.jsx-4306d481946cbdc0{color:#dc3545;font-size:.8rem;margin-top:4px}.field-hint.jsx-4306d481946cbdc0{color:#666;font-size:.8rem;margin-top:4px}.bulk-controls.jsx-4306d481946cbdc0{background:#f8f9fa;padding:20px;-webkit-border-radius:6px;-moz-border-radius:6px;border-radius:6px;margin-bottom:20px;border:1px solid#e9ecef}.bulk-actions.jsx-4306d481946cbdc0{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-moz-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;gap:15px}.checkbox-label.jsx-4306d481946cbdc0{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;cursor:pointer;font-weight:500}.checkbox-label.jsx-4306d481946cbdc0 input[type="checkbox"].jsx-4306d481946cbdc0{margin-right:8px}.bulk-status.jsx-4306d481946cbdc0{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;gap:10px}.bulk-status-select.jsx-4306d481946cbdc0{padding:8px 12px;border:1px solid#ddd;-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px;font-size:14px}.apply-bulk-btn.jsx-4306d481946cbdc0{padding:8px 16px;background:#17a2b8;color:white;border:none;-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px;font-size:14px;cursor:pointer;font-weight:500}.apply-bulk-btn.jsx-4306d481946cbdc0:hover:not(:disabled){background:#138496}.apply-bulk-btn.jsx-4306d481946cbdc0:disabled{opacity:.6;cursor:not-allowed}.employee-list.jsx-4306d481946cbdc0{margin-bottom:20px}.list-header.jsx-4306d481946cbdc0{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-moz-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;margin-bottom:15px;padding-bottom:10px;border-bottom:1px solid#e9ecef}.list-header.jsx-4306d481946cbdc0 h3.jsx-4306d481946cbdc0{margin:0;color:#333}.selected-count.jsx-4306d481946cbdc0{font-size:.9rem;color:#666;font-weight:500}.employee-grid.jsx-4306d481946cbdc0{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:15px}.employee-item.jsx-4306d481946cbdc0{border:2px solid;-webkit-border-radius:8px;-moz-border-radius:8px;border-radius:8px;padding:15px;-webkit-transition:all.2s;-moz-transition:all.2s;-o-transition:all.2s;transition:all.2s}.employee-item.selected.jsx-4306d481946cbdc0{-webkit-transform:translatey(-2px);-moz-transform:translatey(-2px);-ms-transform:translatey(-2px);-o-transform:translatey(-2px);transform:translatey(-2px);-webkit-box-shadow:0 4px 8px rgba(0,0,0,.1);-moz-box-shadow:0 4px 8px rgba(0,0,0,.1);box-shadow:0 4px 8px rgba(0,0,0,.1)}.employee-header.jsx-4306d481946cbdc0{margin-bottom:10px}.employee-name.jsx-4306d481946cbdc0{font-weight:600;color:#333}.employee-info.jsx-4306d481946cbdc0{margin-bottom:15px;font-size:.8rem;color:#666}.employee-info.jsx-4306d481946cbdc0 div.jsx-4306d481946cbdc0{margin-bottom:2px}.status-controls.jsx-4306d481946cbdc0{margin-top:10px}.status-buttons.jsx-4306d481946cbdc0{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;gap:6px}.status-btn.jsx-4306d481946cbdc0{-webkit-box-flex:1;-webkit-flex:1;-moz-box-flex:1;-ms-flex:1;flex:1;padding:6px 8px;border:1px solid#ddd;-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px;background:white;font-size:.75rem;cursor:pointer;-webkit-transition:all.2s;-moz-transition:all.2s;-o-transition:all.2s;transition:all.2s}.status-btn.jsx-4306d481946cbdc0:hover{background:#f8f9fa}.status-btn.active[data-status="present"].jsx-4306d481946cbdc0{background:#28a745;color:white;border-color:#28a745}.status-btn.active[data-status="absent"].jsx-4306d481946cbdc0{background:#dc3545;color:white;border-color:#dc3545}.status-btn.active[data-status="half-day"].jsx-4306d481946cbdc0{background:#ffc107;color:#212529;border-color:#ffc107}.form-actions.jsx-4306d481946cbdc0{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;gap:12px;-webkit-box-pack:end;-webkit-justify-content:flex-end;-moz-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;margin-top:30px;padding-top:20px;border-top:1px solid#eee}.btn-primary.jsx-4306d481946cbdc0,.btn-secondary.jsx-4306d481946cbdc0{padding:12px 24px;border:none;-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px;font-size:14px;font-weight:500;cursor:pointer;-webkit-transition:background-color.2s,-webkit-transform.1s;-moz-transition:background-color.2s,-moz-transform.1s;-o-transition:background-color.2s,-o-transform.1s;transition:background-color.2s,-webkit-transform.1s;transition:background-color.2s,-moz-transform.1s;transition:background-color.2s,-o-transform.1s;transition:background-color.2s,transform.1s}.btn-primary.jsx-4306d481946cbdc0{background:#007cba;color:white}.btn-primary.jsx-4306d481946cbdc0:hover:not(:disabled){background:#005a87;-webkit-transform:translatey(-1px);-moz-transform:translatey(-1px);-ms-transform:translatey(-1px);-o-transform:translatey(-1px);transform:translatey(-1px)}.btn-secondary.jsx-4306d481946cbdc0{background:#f8f9fa;color:#666;border:1px solid#ddd}.btn-secondary.jsx-4306d481946cbdc0:hover:not(:disabled){background:#e9ecef;-webkit-transform:translatey(-1px);-moz-transform:translatey(-1px);-ms-transform:translatey(-1px);-o-transform:translatey(-1px);transform:translatey(-1px)}.btn-primary.jsx-4306d481946cbdc0:disabled,.btn-secondary.jsx-4306d481946cbdc0:disabled{opacity:.6;cursor:not-allowed;-webkit-transform:none;-moz-transform:none;-ms-transform:none;-o-transform:none;transform:none}.attendance-indicator.jsx-4306d481946cbdc0{display:inline-block;margin-left:8px;padding:2px 6px;background:#d4edda;color:#155724;border:1px solid#c3e6cb;-webkit-border-radius:3px;-moz-border-radius:3px;border-radius:3px;font-size:.7rem;font-weight:500;vertical-align:middle}.employee-item.jsx-4306d481946cbdc0:has(.attendance-indicator){border-left:4px solid#28a745}.checking-indicator.jsx-4306d481946cbdc0{background:#e3f2fd;border:1px solid#bbdefb;-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px;padding:8px 12px;margin-bottom:16px;font-size:.9rem;color:#1565c0;text-align:center}.duplicate-info.jsx-4306d481946cbdc0{background:#fff3cd;border:1px solid#ffeaa7;-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px;padding:8px 12px;margin-bottom:16px;font-size:.9rem;color:#856404}.no-duplicates-info.jsx-4306d481946cbdc0{background:#d4edda;border:1px solid#c3e6cb;-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px;padding:8px 12px;margin-bottom:16px;font-size:.9rem;color:#155724}@media(max-width:768px){.attendance-form.jsx-4306d481946cbdc0{padding:10px}.form.jsx-4306d481946cbdc0{padding:20px}.bulk-actions.jsx-4306d481946cbdc0{-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:stretch;-webkit-align-items:stretch;-moz-box-align:stretch;-ms-flex-align:stretch;align-items:stretch}.employee-grid.jsx-4306d481946cbdc0{grid-template-columns:1fr}.form-actions.jsx-4306d481946cbdc0{-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.btn-primary.jsx-4306d481946cbdc0,.btn-secondary.jsx-4306d481946cbdc0{width:100%}}'})]})}}}]);