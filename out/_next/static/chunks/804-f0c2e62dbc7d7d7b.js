"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[804],{4069:function(e,t,a){a.d(t,{CW:function(){return u},Jx:function(){return o},RT:function(){return g},UR:function(){return c},tJ:function(){return r},uO:function(){return n},wO:function(){return i},xi:function(){return d}});let r={WORKER:"Worker",SUPERVISOR:"Supervisor",MANAGER:"Manager",ADMIN:"Admin"};Object.values(r);let n=e=>{let t={},a=!0;if(e.name&&""!==e.name.trim()?e.name.trim().length<2?(t.name="Name must be at least 2 characters long",a=!1):e.name.trim().length>100&&(t.name="Name must not exceed 100 characters",a=!1):(t.name="Name is required",a=!1),e.designation&&""!==e.designation.trim()?Object.values(r).includes(e.designation)||(t.designation="Please select a valid designation",a=!1):(t.designation="Designation is required",a=!1),e.aadhar_id&&""!==e.aadhar_id.trim()&&!/^\d{12}$/.test(e.aadhar_id.trim())&&(t.aadhar_id="Aadhar ID must be exactly 12 digits",a=!1),e.joining_date){let r=new Date(e.joining_date),n=new Date,i=new Date("1990-01-01");isNaN(r.getTime())?(t.joining_date="Invalid joining date",a=!1):r>n?(t.joining_date="Joining date cannot be in the future",a=!1):r<i&&(t.joining_date="Joining date cannot be before 1990",a=!1)}else t.joining_date="Joining date is required",a=!1;if(void 0!==e.age&&null!==e.age&&""!==e.age){let r=parseInt(e.age);(isNaN(r)||r<18||r>65)&&(t.age="Age must be between 18 and 65",a=!1)}return{isValid:a,errors:t}},i=e=>{var t;return e?{...e,name:(null===(t=e.name)||void 0===t?void 0:t.trim())||"N/A",designation:e.designation||"Not specified",aadhar_id:e.aadhar_id?l(e.aadhar_id):"Not provided",joining_date:e.joining_date?s(e.joining_date):"N/A",age:e.age?"".concat(e.age," years"):"Not specified",formatted_joining_date:e.joining_date?new Date(e.joining_date).toLocaleDateString():"N/A"}:null},o=e=>{var t,a;let r={name:(null===(t=e.name)||void 0===t?void 0:t.trim())||"",designation:(null===(a=e.designation)||void 0===a?void 0:a.trim())||"",joining_date:e.joining_date||null};return e.aadhar_id&&""!==e.aadhar_id.trim()&&(r.aadhar_id=e.aadhar_id.trim()),void 0!==e.age&&null!==e.age&&""!==e.age&&(r.age=parseInt(e.age)),r},l=e=>e&&12===e.length?"".concat(e.substring(0,4),"-****-").concat(e.substring(8)):e,s=e=>{if(!e)return"N/A";try{let t="string"==typeof e?new Date(e):e;if(isNaN(t.getTime()))return"Invalid Date";return t.toLocaleDateString("en-IN",{year:"numeric",month:"long",day:"numeric"})}catch(e){return"Invalid Date"}},c=e=>{if(!e)return"N/A";try{let t=new Date(e),a=new Date;if(isNaN(t.getTime()))return"N/A";let r=Math.ceil(Math.abs(a-t)/864e5),n=Math.floor(r/365),i=Math.floor(r%365/30);if(0===n&&0===i)return"Less than a month";if(0===n)return"".concat(i," month").concat(i>1?"s":"");if(0===i)return"".concat(n," year").concat(n>1?"s":"");return"".concat(n," year").concat(n>1?"s":"",", ").concat(i," month").concat(i>1?"s":"")}catch(e){return"N/A"}},d=e=>{let t=[];if(e.name){t.push(e.name.toLowerCase());let a=e.name.toLowerCase().split(" ");t.push(...a)}if(e.designation&&t.push(e.designation.toLowerCase()),e.aadhar_id&&t.push(e.aadhar_id),e.joining_date){let a=new Date(e.joining_date).getFullYear();t.push(a.toString())}return[...new Set(t)]},u=()=>({name:"",designation:"",aadhar_id:"",joining_date:"",age:""}),g=e=>{if(!e)return{status:"unknown",label:"Unknown",color:"#6c757d"};try{let t=new Date(e),a=new Date,r=Math.floor((a-t)/864e5);if(r<0)return{status:"future",label:"Future Joining",color:"#17a2b8"};if(r<=90)return{status:"new",label:"New Employee",color:"#28a745"};if(r<=365)return{status:"recent",label:"Recent Hire",color:"#ffc107"};return{status:"experienced",label:"Experienced",color:"#007bff"}}catch(e){return{status:"unknown",label:"Unknown",color:"#6c757d"}}}},8804:function(e,t,a){var r=a(5799),n=a(4069);class i{async createEmployee(e){try{let t=(0,n.uO)(e);if(!t.isValid)throw Error("Validation failed: ".concat(Object.values(t.errors).join(", ")));if(e.aadhar_id&&""!==e.aadhar_id.trim()&&await this.findByAadharId(e.aadhar_id.trim()))throw Error("An employee with this Aadhar ID already exists");let a=(0,n.Jx)(e);return a.searchKeywords=(0,n.xi)(a),a.status="active",{id:(await r.Z.addDocument(this.collectionName,a)).id,...a}}catch(e){throw console.error("Error creating employee:",e),e}}async getEmployee(e){try{return await r.Z.getDocument(this.collectionName,e)}catch(e){throw console.error("Error getting employee:",e),e}}async updateEmployee(e,t){try{let a=(0,n.uO)(t);if(!a.isValid)throw Error("Validation failed: ".concat(Object.values(a.errors).join(", ")));if(t.aadhar_id&&""!==t.aadhar_id.trim()){let a=await this.findByAadharId(t.aadhar_id.trim());if(a&&a.id!==e)throw Error("An employee with this Aadhar ID already exists")}let i=(0,n.Jx)(t);i.searchKeywords=(0,n.xi)(i),await r.Z.updateDocument(this.collectionName,e,i)}catch(e){throw console.error("Error updating employee:",e),e}}async deleteEmployee(e){try{await r.Z.updateDocument(this.collectionName,e,{status:"inactive",deletedAt:new Date().toISOString()})}catch(e){throw console.error("Error deleting employee:",e),e}}async permanentlyDeleteEmployee(e){try{await r.Z.deleteDocument(this.collectionName,e)}catch(e){throw console.error("Error permanently deleting employee:",e),e}}async getAllEmployees(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{let t={where:[{field:"status",operator:"==",value:"active"}],...e};return(await r.Z.getDocuments(this.collectionName,t)).sort((e,t)=>{var a,r;let n=(null===(a=e.createdAt)||void 0===a?void 0:a.seconds)||0;return((null===(r=t.createdAt)||void 0===r?void 0:r.seconds)||0)-n})}catch(e){throw console.error("Error getting all employees:",e),e}}async searchEmployees(e){try{if(!e||""===e.trim())return await this.getAllEmployees();let t=e.toLowerCase().trim();return(await this.getAllEmployees()).filter(e=>!!(e.name&&e.name.toLowerCase().includes(t)||e.aadhar_id&&e.aadhar_id.includes(t)||e.searchKeywords&&e.searchKeywords.some(e=>e.includes(t))))}catch(e){throw console.error("Error searching employees:",e),e}}async findByAadharId(e){try{if(!e||""===e.trim())return null;let t=(await r.Z.getDocuments(this.collectionName,{where:[{field:"aadhar_id",operator:"==",value:e.trim()}],limit:1})).filter(e=>"active"===e.status);return t.length>0?t[0]:null}catch(e){throw console.error("Error finding employee by Aadhar ID:",e),e}}async getEmployeesByJoiningDateRange(e,t){try{return(await this.getAllEmployees()).filter(a=>{if(!a.joining_date)return!1;let r=new Date(a.joining_date);return r>=e&&r<=t})}catch(e){throw console.error("Error getting employees by joining date range:",e),e}}async getEmployeesByAgeRange(e,t){try{return(await this.getAllEmployees()).filter(a=>!!a.age&&a.age>=e&&a.age<=t)}catch(e){throw console.error("Error getting employees by age range:",e),e}}async getEmployeeStats(){try{let e=await this.getAllEmployees(),t={total:e.length,withAadhar:e.filter(e=>e.aadhar_id).length,withAge:e.filter(e=>e.age).length,avgAge:0,newestHire:null,oldestHire:null,ageDistribution:{"18-25":0,"26-35":0,"36-45":0,"46-55":0,"56-65":0}};if(e.length>0){let a=e.filter(e=>e.age);a.length>0&&(t.avgAge=Math.round(a.reduce((e,t)=>e+t.age,0)/a.length));let r=e.filter(e=>e.joining_date).sort((e,t)=>new Date(t.joining_date)-new Date(e.joining_date));r.length>0&&(t.newestHire=r[0],t.oldestHire=r[r.length-1]),a.forEach(e=>{let a=e.age;a>=18&&a<=25?t.ageDistribution["18-25"]++:a>=26&&a<=35?t.ageDistribution["26-35"]++:a>=36&&a<=45?t.ageDistribution["36-45"]++:a>=46&&a<=55?t.ageDistribution["46-55"]++:a>=56&&a<=65&&t.ageDistribution["56-65"]++})}return t}catch(e){throw console.error("Error getting employee stats:",e),e}}subscribeToEmployees(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let a={where:[{field:"status",operator:"==",value:"active"}],...t};return r.Z.subscribeToCollection(this.collectionName,t=>{let a=t.sort((e,t)=>{var a,r;let n=(null===(a=e.createdAt)||void 0===a?void 0:a.seconds)||0;return((null===(r=t.createdAt)||void 0===r?void 0:r.seconds)||0)-n});e(a)},a)}catch(e){throw console.error("Error subscribing to employees:",e),e}}subscribeToEmployee(e,t){try{return r.Z.subscribeToDocument(this.collectionName,e,t)}catch(e){throw console.error("Error subscribing to employee:",e),e}}async batchCreateEmployees(e){try{let t=[],a=[];for(let r=0;r<e.length;r++)try{let a=await this.createEmployee(e[r]);t.push({index:r,success:!0,employee:a})}catch(t){a.push({index:r,error:t.message,data:e[r]})}return{results:t,errors:a}}catch(e){throw console.error("Error batch creating employees:",e),e}}constructor(){this.collectionName="employees"}}let o=new i;t.Z=o}}]);