"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[724],{5724:function(e,a,s){var t=s(5893),b=s(645),r=s.n(b),o=s(7294),i=s(3615),n=s(5468),l=s(8968);a.Z=e=>{let{employees:a=[],selectedDate:s=null,mode:b="single",onSubmit:d,onCancel:x,loading:c=!1}=e,{user:m}=(0,i.a)(),[p,u]=(0,o.useState)({date:s||new Date().toISOString().split("T")[0],employees:[],bulkStatus:n.H8.PRESENT,notes:""}),[f,j]=(0,o.useState)(new Set),[g,h]=(0,o.useState)(!1),[k,y]=(0,o.useState)(!1),[w,z]=(0,o.useState)({}),[N,v]=(0,o.useState)(new Set),[S,A]=(0,o.useState)(!1);(0,o.useEffect)(()=>{s&&u(e=>({...e,date:s}))},[s]),(0,o.useEffect)(()=>{if(a.length>0&&"bulk"===b){let e=a.map(e=>({...(0,n.dP)(),employee_id:e.id,employee_name:e.name,date:p.date,status:n.H8.PRESENT,marked_by:(null==m?void 0:m.uid)||(null==m?void 0:m.email)||"admin"}));u(a=>({...a,employees:e}))}},[a,b,m,p.date]),(0,o.useEffect)(()=>{(async()=>{if(a.length>0&&p.date&&"bulk"===b){A(!0);try{let e=a.map(e=>e.id),s=await l.Z.getEmployeesWithAttendanceForDate(e,p.date);v(s)}catch(e){console.error("Error checking existing attendance:",e),v(new Set)}finally{A(!1)}}})()},[a,p.date,b]);let E=(e,a)=>{u(s=>({...s,employees:s.employees.map(s=>s.employee_id===e?{...s,status:a}:s)}))},H=e=>{let s=new Set(f);s.has(e)?s.delete(e):s.add(e),j(s),h(s.size===a.length)},D=()=>{let e={};return p.date?new Date(p.date)>new Date&&(e.date="Cannot mark attendance for future dates"):e.date="Date is required","bulk"===b&&0===f.size&&(e.employees="Please select at least one employee"),z(e),0===Object.keys(e).length},_=async e=>{if(e.preventDefault(),D()){y(!0);try{if("bulk"===b){let e=p.employees.filter(e=>f.has(e.employee_id));await d(e)}else await d(p)}catch(e){console.error("Form submission error:",e),z({general:e.message||"An error occurred while marking attendance"})}finally{y(!1)}}},C=e=>{switch(e){case n.H8.PRESENT:return"#d4edda";case n.H8.ABSENT:return"#f8d7da";case n.H8.HALF_DAY:return"#fff3cd";default:return"#f8f9fa"}},T=e=>{switch(e){case n.H8.PRESENT:return"#c3e6cb";case n.H8.ABSENT:return"#f5c6cb";case n.H8.HALF_DAY:return"#ffeaa7";default:return"#dee2e6"}};return(0,t.jsxs)("div",{className:"jsx-a5a178bb2a8b13e4 attendance-form",children:[(0,t.jsxs)("form",{onSubmit:_,className:"jsx-a5a178bb2a8b13e4 form",children:[(0,t.jsxs)("div",{className:"jsx-a5a178bb2a8b13e4 form-header",children:[(0,t.jsx)("h2",{className:"jsx-a5a178bb2a8b13e4",children:"bulk"===b?"Mark Bulk Attendance":"Mark Attendance"}),(0,t.jsx)("p",{className:"jsx-a5a178bb2a8b13e4 form-description",children:"Mark attendance for employees on the selected date"})]}),w.general&&(0,t.jsxs)("div",{className:"jsx-a5a178bb2a8b13e4 error-banner",children:[(0,t.jsx)("strong",{className:"jsx-a5a178bb2a8b13e4",children:"Error:"})," ",w.general]}),(0,t.jsxs)("div",{className:"jsx-a5a178bb2a8b13e4 form-group",children:[(0,t.jsx)("label",{htmlFor:"date",className:"jsx-a5a178bb2a8b13e4 form-label",children:"Attendance Date *"}),(0,t.jsx)("input",{type:"date",id:"date",value:p.date,onChange:e=>{let a=e.target.value;u(e=>({...e,date:a,employees:e.employees.map(e=>({...e,date:a}))})),w.date&&z(e=>({...e,date:""}))},max:new Date().toISOString().split("T")[0],required:!0,className:"jsx-a5a178bb2a8b13e4 "+"form-input ".concat(w.date?"error":"")}),w.date&&(0,t.jsx)("div",{className:"jsx-a5a178bb2a8b13e4 error-message",children:w.date})]}),"bulk"===b&&(0,t.jsxs)(t.Fragment,{children:[S&&(0,t.jsx)("div",{className:"jsx-a5a178bb2a8b13e4 checking-indicator",children:(0,t.jsxs)("span",{className:"jsx-a5a178bb2a8b13e4",children:["\uD83D\uDD0D Checking existing attendance for ",p.date,"..."]})}),!S&&N.size>0&&(0,t.jsx)("div",{className:"jsx-a5a178bb2a8b13e4 duplicate-info",children:(0,t.jsxs)("span",{className:"jsx-a5a178bb2a8b13e4",children:["ℹ️ ",N.size," employee(s) already have attendance marked for this date. Selecting them will update their existing records."]})}),!S&&0===N.size&&a.length>0&&(0,t.jsx)("div",{className:"jsx-a5a178bb2a8b13e4 no-duplicates-info",children:(0,t.jsxs)("span",{className:"jsx-a5a178bb2a8b13e4",children:["✅ No existing attendance found for ",p.date,". All records will be created as new."]})}),(0,t.jsxs)("div",{className:"jsx-a5a178bb2a8b13e4 bulk-controls",children:[(0,t.jsxs)("div",{className:"jsx-a5a178bb2a8b13e4 bulk-actions",children:[(0,t.jsx)("div",{className:"jsx-a5a178bb2a8b13e4 select-all",children:(0,t.jsxs)("label",{className:"jsx-a5a178bb2a8b13e4 checkbox-label",children:[(0,t.jsx)("input",{type:"checkbox",checked:g,onChange:()=>{g?j(new Set):j(new Set(a.map(e=>e.id))),h(!g)},className:"jsx-a5a178bb2a8b13e4"}),(0,t.jsxs)("span",{className:"jsx-a5a178bb2a8b13e4",children:["Select All (",a.length," employees)"]})]})}),(0,t.jsxs)("div",{className:"jsx-a5a178bb2a8b13e4 bulk-status",children:[(0,t.jsxs)("select",{value:p.bulkStatus,onChange:e=>{let a=e.target.value;u(e=>({...e,bulkStatus:a,employees:e.employees.map(e=>f.has(e.employee_id)?{...e,status:a}:e)}))},className:"jsx-a5a178bb2a8b13e4 bulk-status-select",children:[(0,t.jsx)("option",{value:n.H8.PRESENT,className:"jsx-a5a178bb2a8b13e4",children:"Mark as Present"}),(0,t.jsx)("option",{value:n.H8.ABSENT,className:"jsx-a5a178bb2a8b13e4",children:"Mark as Absent"}),(0,t.jsx)("option",{value:n.H8.HALF_DAY,className:"jsx-a5a178bb2a8b13e4",children:"Mark as Half Day"})]}),(0,t.jsxs)("button",{type:"button",onClick:()=>{u(e=>({...e,employees:e.employees.map(e=>f.has(e.employee_id)?{...e,status:p.bulkStatus}:e)}))},disabled:0===f.size,className:"jsx-a5a178bb2a8b13e4 apply-bulk-btn",children:["Apply to Selected (",f.size,")"]})]})]}),w.employees&&(0,t.jsx)("div",{className:"jsx-a5a178bb2a8b13e4 error-message",children:w.employees})]}),(0,t.jsxs)("div",{className:"jsx-a5a178bb2a8b13e4 employee-list",children:[(0,t.jsxs)("div",{className:"jsx-a5a178bb2a8b13e4 list-header",children:[(0,t.jsxs)("h3",{className:"jsx-a5a178bb2a8b13e4",children:["Employees (",a.length,")"]}),(0,t.jsxs)("div",{className:"jsx-a5a178bb2a8b13e4 selected-count",children:["Selected: ",f.size," / ",a.length]})]}),(0,t.jsx)("div",{className:"jsx-a5a178bb2a8b13e4 employee-grid",children:p.employees.map((e,s)=>{let b=a.find(a=>a.id===e.employee_id);if(!b)return null;let r=f.has(b.id);return(0,t.jsxs)("div",{style:{backgroundColor:C(e.status),borderColor:T(e.status)},className:"jsx-a5a178bb2a8b13e4 "+"employee-item ".concat(r?"selected":""),children:[(0,t.jsx)("div",{className:"jsx-a5a178bb2a8b13e4 employee-header",children:(0,t.jsxs)("label",{className:"jsx-a5a178bb2a8b13e4 checkbox-label",children:[(0,t.jsx)("input",{type:"checkbox",checked:r,onChange:()=>H(b.id),className:"jsx-a5a178bb2a8b13e4"}),(0,t.jsxs)("span",{className:"jsx-a5a178bb2a8b13e4 employee-name",children:[b.name,N.has(b.id)&&(0,t.jsx)("span",{title:"Attendance already marked for this date",className:"jsx-a5a178bb2a8b13e4 attendance-indicator",children:"✅ Already Marked"})]})]})}),(0,t.jsxs)("div",{className:"jsx-a5a178bb2a8b13e4 employee-info",children:[(0,t.jsxs)("div",{className:"jsx-a5a178bb2a8b13e4 employee-id",children:["ID: ",b.id.slice(0,8),"..."]}),b.designation&&(0,t.jsx)("div",{className:"jsx-a5a178bb2a8b13e4 employee-designation",children:b.designation}),b.aadhar_id&&(0,t.jsxs)("div",{className:"jsx-a5a178bb2a8b13e4 employee-aadhar",children:["Aadhar: ",b.aadhar_id.slice(0,4),"****",b.aadhar_id.slice(-4)]})]}),(0,t.jsx)("div",{className:"jsx-a5a178bb2a8b13e4 status-controls",children:(0,t.jsx)("div",{className:"jsx-a5a178bb2a8b13e4 status-buttons",children:Object.values(n.H8).map(a=>(0,t.jsxs)("button",{type:"button",onClick:()=>E(b.id,a),"data-status":a,className:"jsx-a5a178bb2a8b13e4 "+"status-btn ".concat(e.status===a?"active":""),children:[a===n.H8.PRESENT&&"✓ Present",a===n.H8.ABSENT&&"✗ Absent",a===n.H8.HALF_DAY&&"◐ Half Day"]},a))})})]},b.id)})})]})]}),(0,t.jsxs)("div",{className:"jsx-a5a178bb2a8b13e4 form-group",children:[(0,t.jsx)("label",{htmlFor:"notes",className:"jsx-a5a178bb2a8b13e4 form-label",children:"Notes (Optional)"}),(0,t.jsx)("textarea",{id:"notes",value:p.notes,onChange:e=>u(a=>({...a,notes:e.target.value})),placeholder:"Add any additional notes about attendance...",rows:"3",maxLength:"500",className:"jsx-a5a178bb2a8b13e4 form-textarea"}),(0,t.jsxs)("div",{className:"jsx-a5a178bb2a8b13e4 field-hint",children:[p.notes.length,"/500 characters"]})]}),(0,t.jsxs)("div",{className:"jsx-a5a178bb2a8b13e4 form-actions",children:[(0,t.jsx)("button",{type:"button",onClick:x,disabled:k||c,className:"jsx-a5a178bb2a8b13e4 btn-secondary",children:"Cancel"}),(0,t.jsx)("button",{type:"submit",disabled:k||c||"bulk"===b&&0===f.size,className:"jsx-a5a178bb2a8b13e4 btn-primary",children:k||c?"Marking Attendance...":"Mark Attendance".concat("bulk"===b?" (".concat(f.size,")"):"")})]})]}),(0,t.jsx)(r(),{id:"a5a178bb2a8b13e4",children:'.attendance-form.jsx-a5a178bb2a8b13e4{max-width:1e3px;margin:0 auto;padding:20px}.form.jsx-a5a178bb2a8b13e4{background:white;padding:30px;-webkit-border-radius:8px;-moz-border-radius:8px;border-radius:8px;-webkit-box-shadow:0 2px 10px rgba(0,0,0,.1);-moz-box-shadow:0 2px 10px rgba(0,0,0,.1);box-shadow:0 2px 10px rgba(0,0,0,.1)}.form-header.jsx-a5a178bb2a8b13e4{margin-bottom:30px;text-align:center}.form-header.jsx-a5a178bb2a8b13e4 h2.jsx-a5a178bb2a8b13e4{margin:0 0 10px 0;color:#333;font-size:1.5rem}.form-description.jsx-a5a178bb2a8b13e4{margin:0;color:#666;font-size:.9rem}.error-banner.jsx-a5a178bb2a8b13e4{background:#fee;color:#c33;padding:12px;-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px;margin-bottom:20px;border:1px solid#fcc}.form-group.jsx-a5a178bb2a8b13e4{margin-bottom:20px}.form-label.jsx-a5a178bb2a8b13e4{display:block;margin-bottom:6px;font-weight:500;color:#333;font-size:.9rem}.form-input.jsx-a5a178bb2a8b13e4,.form-textarea.jsx-a5a178bb2a8b13e4{width:100%;padding:12px;border:1px solid#ddd;-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px;font-size:14px;-webkit-transition:border-color.2s,box-shadow.2s;-moz-transition:border-color.2s,box-shadow.2s;-o-transition:border-color.2s,box-shadow.2s;transition:border-color.2s,box-shadow.2s}.form-input.jsx-a5a178bb2a8b13e4:focus,.form-textarea.jsx-a5a178bb2a8b13e4:focus{outline:none;border-color:#007cba;-webkit-box-shadow:0 0 0 2px rgba(0,124,186,.2);-moz-box-shadow:0 0 0 2px rgba(0,124,186,.2);box-shadow:0 0 0 2px rgba(0,124,186,.2)}.form-input.error.jsx-a5a178bb2a8b13e4,.form-textarea.error.jsx-a5a178bb2a8b13e4{border-color:#dc3545}.error-message.jsx-a5a178bb2a8b13e4{color:#dc3545;font-size:.8rem;margin-top:4px}.field-hint.jsx-a5a178bb2a8b13e4{color:#666;font-size:.8rem;margin-top:4px}.bulk-controls.jsx-a5a178bb2a8b13e4{background:#f8f9fa;padding:20px;-webkit-border-radius:6px;-moz-border-radius:6px;border-radius:6px;margin-bottom:20px;border:1px solid#e9ecef}.bulk-actions.jsx-a5a178bb2a8b13e4{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-moz-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;gap:15px}.checkbox-label.jsx-a5a178bb2a8b13e4{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;cursor:pointer;font-weight:500}.checkbox-label.jsx-a5a178bb2a8b13e4 input[type="checkbox"].jsx-a5a178bb2a8b13e4{margin-right:8px}.bulk-status.jsx-a5a178bb2a8b13e4{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;gap:10px}.bulk-status-select.jsx-a5a178bb2a8b13e4{padding:8px 12px;border:1px solid#ddd;-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px;font-size:14px}.apply-bulk-btn.jsx-a5a178bb2a8b13e4{padding:8px 16px;background:#17a2b8;color:white;border:none;-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px;font-size:14px;cursor:pointer;font-weight:500}.apply-bulk-btn.jsx-a5a178bb2a8b13e4:hover:not(:disabled){background:#138496}.apply-bulk-btn.jsx-a5a178bb2a8b13e4:disabled{opacity:.6;cursor:not-allowed}.employee-list.jsx-a5a178bb2a8b13e4{margin-bottom:20px}.list-header.jsx-a5a178bb2a8b13e4{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-moz-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;margin-bottom:15px;padding-bottom:10px;border-bottom:1px solid#e9ecef}.list-header.jsx-a5a178bb2a8b13e4 h3.jsx-a5a178bb2a8b13e4{margin:0;color:#333}.selected-count.jsx-a5a178bb2a8b13e4{font-size:.9rem;color:#666;font-weight:500}.employee-grid.jsx-a5a178bb2a8b13e4{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:15px}.employee-item.jsx-a5a178bb2a8b13e4{border:2px solid;-webkit-border-radius:8px;-moz-border-radius:8px;border-radius:8px;padding:15px;-webkit-transition:all.2s;-moz-transition:all.2s;-o-transition:all.2s;transition:all.2s}.employee-item.selected.jsx-a5a178bb2a8b13e4{-webkit-transform:translatey(-2px);-moz-transform:translatey(-2px);-ms-transform:translatey(-2px);-o-transform:translatey(-2px);transform:translatey(-2px);-webkit-box-shadow:0 4px 8px rgba(0,0,0,.1);-moz-box-shadow:0 4px 8px rgba(0,0,0,.1);box-shadow:0 4px 8px rgba(0,0,0,.1)}.employee-header.jsx-a5a178bb2a8b13e4{margin-bottom:10px}.employee-name.jsx-a5a178bb2a8b13e4{font-weight:600;color:#333}.employee-info.jsx-a5a178bb2a8b13e4{margin-bottom:15px;font-size:.8rem;color:#666}.employee-info.jsx-a5a178bb2a8b13e4 div.jsx-a5a178bb2a8b13e4{margin-bottom:2px}.employee-designation.jsx-a5a178bb2a8b13e4{color:#1d4ed8!important;font-weight:600;text-transform:capitalize}.status-controls.jsx-a5a178bb2a8b13e4{margin-top:10px}.status-buttons.jsx-a5a178bb2a8b13e4{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;gap:6px}.status-btn.jsx-a5a178bb2a8b13e4{-webkit-box-flex:1;-webkit-flex:1;-moz-box-flex:1;-ms-flex:1;flex:1;padding:6px 8px;border:1px solid#ddd;-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px;background:white;font-size:.75rem;cursor:pointer;-webkit-transition:all.2s;-moz-transition:all.2s;-o-transition:all.2s;transition:all.2s}.status-btn.jsx-a5a178bb2a8b13e4:hover{background:#f8f9fa}.status-btn.active[data-status="present"].jsx-a5a178bb2a8b13e4{background:#28a745;color:white;border-color:#28a745}.status-btn.active[data-status="absent"].jsx-a5a178bb2a8b13e4{background:#dc3545;color:white;border-color:#dc3545}.status-btn.active[data-status="half-day"].jsx-a5a178bb2a8b13e4{background:#ffc107;color:#212529;border-color:#ffc107}.form-actions.jsx-a5a178bb2a8b13e4{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;gap:12px;-webkit-box-pack:end;-webkit-justify-content:flex-end;-moz-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;margin-top:30px;padding-top:20px;border-top:1px solid#eee}.btn-primary.jsx-a5a178bb2a8b13e4,.btn-secondary.jsx-a5a178bb2a8b13e4{padding:12px 24px;border:none;-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px;font-size:14px;font-weight:500;cursor:pointer;-webkit-transition:background-color.2s,-webkit-transform.1s;-moz-transition:background-color.2s,-moz-transform.1s;-o-transition:background-color.2s,-o-transform.1s;transition:background-color.2s,-webkit-transform.1s;transition:background-color.2s,-moz-transform.1s;transition:background-color.2s,-o-transform.1s;transition:background-color.2s,transform.1s}.btn-primary.jsx-a5a178bb2a8b13e4{background:#007cba;color:white}.btn-primary.jsx-a5a178bb2a8b13e4:hover:not(:disabled){background:#005a87;-webkit-transform:translatey(-1px);-moz-transform:translatey(-1px);-ms-transform:translatey(-1px);-o-transform:translatey(-1px);transform:translatey(-1px)}.btn-secondary.jsx-a5a178bb2a8b13e4{background:#f8f9fa;color:#666;border:1px solid#ddd}.btn-secondary.jsx-a5a178bb2a8b13e4:hover:not(:disabled){background:#e9ecef;-webkit-transform:translatey(-1px);-moz-transform:translatey(-1px);-ms-transform:translatey(-1px);-o-transform:translatey(-1px);transform:translatey(-1px)}.btn-primary.jsx-a5a178bb2a8b13e4:disabled,.btn-secondary.jsx-a5a178bb2a8b13e4:disabled{opacity:.6;cursor:not-allowed;-webkit-transform:none;-moz-transform:none;-ms-transform:none;-o-transform:none;transform:none}.attendance-indicator.jsx-a5a178bb2a8b13e4{display:inline-block;margin-left:8px;padding:2px 6px;background:#d4edda;color:#155724;border:1px solid#c3e6cb;-webkit-border-radius:3px;-moz-border-radius:3px;border-radius:3px;font-size:.7rem;font-weight:500;vertical-align:middle}.employee-item.jsx-a5a178bb2a8b13e4:has(.attendance-indicator){border-left:4px solid#28a745}.checking-indicator.jsx-a5a178bb2a8b13e4{background:#e3f2fd;border:1px solid#bbdefb;-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px;padding:8px 12px;margin-bottom:16px;font-size:.9rem;color:#1565c0;text-align:center}.duplicate-info.jsx-a5a178bb2a8b13e4{background:#fff3cd;border:1px solid#ffeaa7;-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px;padding:8px 12px;margin-bottom:16px;font-size:.9rem;color:#856404}.no-duplicates-info.jsx-a5a178bb2a8b13e4{background:#d4edda;border:1px solid#c3e6cb;-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px;padding:8px 12px;margin-bottom:16px;font-size:.9rem;color:#155724}@media(max-width:768px){.attendance-form.jsx-a5a178bb2a8b13e4{padding:10px}.form.jsx-a5a178bb2a8b13e4{padding:20px}.bulk-actions.jsx-a5a178bb2a8b13e4{-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:stretch;-webkit-align-items:stretch;-moz-box-align:stretch;-ms-flex-align:stretch;align-items:stretch}.employee-grid.jsx-a5a178bb2a8b13e4{grid-template-columns:1fr}.form-actions.jsx-a5a178bb2a8b13e4{-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.btn-primary.jsx-a5a178bb2a8b13e4,.btn-secondary.jsx-a5a178bb2a8b13e4{width:100%}}'})]})}}}]);